## 1. 检查继承图，确保继承图合法
1. 图中不存在环
2. 所有父节点都被定义了（A 继承了 B，但是B没有被定义，这个时候也是没有环的）
3. 对于自带的四个类
    - IO: 可以被继承，不能被重新定义
    - Int: 不可被继承，不可被重新定义
    - String: 不可以被继承，不可以被重新定义
    - Bool: 不可以被继承，不可以被重新定义
4. 不可以继承SELF_TYPE
5. 文件中一定要包含Main类

所有的Class也不能被重新定义

首先直接检查条件2和条件3，然后利用拓扑排序的方法检查条件1是否满足即可。

每个class中包含四个部分：
- name : Symbol
- parent: Symbol
- features: Features
- filename: Symbol

## 2. 检查其他语义条件

Type Environment:
1. Object Environment (O), 记录当前环境中各个符号的类型。（以Symbol为key，以Symbol为Value）输入变量名，输出该变量的类型。
2. Method Environment (M), 记录每个类的每个方法的形参列表（形参名称和类型）、返回值类型。
3. C，当前执行所在的类。

对于第二个，需要先扫描一遍所有的类以及他对应的method的函数签名，构造出Method Environment
对于第一条，只需要维护一个符号表即可。

在遍历一个AST的时候，如下的表达式会引入新的scope：
1. 当前检查的类定义的属性。
2. 一个方法的形式参数。
3. let表达式。
4. case分支。

对于第三个，由于在检查的过程中是一个类、一个函数进行检查的。
所以只需要维护一个变量表示当前的类即可。当进入一个新的类里面就
更新这个变量。


### 2.1 类型检查

主要的目的是给AST的每个表达式节点都分配一个类型。

对于每个表达式节点，其检查的步骤如下：
1. 首先对条件进行检查，递归调用，并获取对应依赖的子表达式的类型。以及类型要求的条件。
2. 处理计算返回当前表达式的类型。

同时对于每一个函数，还需要检查其内部expr的类型和
其申明的返回值类型相匹配。

如果一个函数内部发生了对另外一个函数的调用，则只需要比较传入的类型，以及申明的类型
是否匹配即可。
